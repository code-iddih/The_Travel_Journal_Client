{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router-dom\";import EntryDetail from\"../components/EntryDetail\";import PhotoUpload from\"../components/PhotoUpload\";import{getEntry,getEntryPhotos,deletePhoto}from\"../utils/api\";// import deletePhoto\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function EntryDetailPage(){const{id}=useParams();const[entry,setEntry]=useState(null);const[photos,setPhotos]=useState([]);useEffect(()=>{const fetchEntryAndPhotos=async()=>{try{const[entryResponse,photosResponse]=await Promise.all([getEntry(id),getEntryPhotos(id)]);setEntry(entryResponse.data);setPhotos(photosResponse.data);}catch(error){console.error(\"Error fetching entry and photos:\",error);}};fetchEntryAndPhotos();},[id]);const handlePhotoUploaded=newPhoto=>{setPhotos([...photos,newPhoto]);};// Function to handle deleting a photo\nconst handleDeletePhoto=async photoId=>{try{await deletePhoto(id,photoId);// Call API to delete photo\nsetPhotos(photos.filter(photo=>photo.id!==photoId));// Update state after deletion\n}catch(error){console.error(\"Error deleting photo:\",error);}};if(!entry)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mt-4\",children:\"Photos\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:photos.map(photo=>/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"img\",{src:photo.url,className:\"card-img-top\",alt:photo.description||\"Photo\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:photo.description}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>handleDeletePhoto(photo.id),children:\"Delete Photo\"})]})]})},photo.id))}),/*#__PURE__*/_jsx(EntryDetail,{entryId:id}),/*#__PURE__*/_jsx(PhotoUpload,{entryId:entry.id,onPhotoUploaded:handlePhotoUploaded})]});}export default EntryDetailPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","EntryDetail","PhotoUpload","getEntry","getEntryPhotos","deletePhoto","jsx","_jsx","jsxs","_jsxs","EntryDetailPage","id","entry","setEntry","photos","setPhotos","fetchEntryAndPhotos","entryResponse","photosResponse","Promise","all","data","error","console","handlePhotoUploaded","newPhoto","handleDeletePhoto","photoId","filter","photo","children","className","map","src","url","alt","description","onClick","entryId","onPhotoUploaded"],"sources":["/home/code-iddih/Music/client/src/pages/EntryDetailPage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport EntryDetail from \"../components/EntryDetail\";\nimport PhotoUpload from \"../components/PhotoUpload\";\nimport { getEntry, getEntryPhotos, deletePhoto } from \"../utils/api\"; // import deletePhoto\n\nfunction EntryDetailPage() {\n  const { id } = useParams();\n  const [entry, setEntry] = useState(null);\n  const [photos, setPhotos] = useState([]);\n\n  useEffect(() => {\n    const fetchEntryAndPhotos = async () => {\n      try {\n        const [entryResponse, photosResponse] = await Promise.all([\n          getEntry(id),\n          getEntryPhotos(id),\n        ]);\n        setEntry(entryResponse.data);\n        setPhotos(photosResponse.data);\n      } catch (error) {\n        console.error(\"Error fetching entry and photos:\", error);\n      }\n    };\n    fetchEntryAndPhotos();\n  }, [id]);\n\n  const handlePhotoUploaded = (newPhoto) => {\n    setPhotos([...photos, newPhoto]);\n  };\n\n  // Function to handle deleting a photo\n  const handleDeletePhoto = async (photoId) => {\n    try {\n      await deletePhoto(id, photoId); // Call API to delete photo\n      setPhotos(photos.filter((photo) => photo.id !== photoId)); // Update state after deletion\n    } catch (error) {\n      console.error(\"Error deleting photo:\", error);\n    }\n  };\n\n  if (!entry) return <div>Loading...</div>;\n\n  return (\n    <div>\n      <h2 className=\"mt-4\">Photos</h2>\n      <div className=\"row\">\n        {photos.map((photo) => (\n          <div key={photo.id} className=\"col-md-4 mb-4\">\n            <div className=\"card\">\n              <img\n                src={photo.url}\n                className=\"card-img-top\"\n                alt={photo.description || \"Photo\"}\n              />\n              <div className=\"card-body\">\n                <p className=\"card-text\">{photo.description}</p>\n                {/* Delete Button */}\n                <button\n                  className=\"btn btn-danger\"\n                  onClick={() => handleDeletePhoto(photo.id)}\n                >\n                  Delete Photo\n                </button>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n      <EntryDetail entryId={id} />\n      <PhotoUpload entryId={entry.id} onPhotoUploaded={handlePhotoUploaded} />\n    </div>\n  );\n}\n\nexport default EntryDetailPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}